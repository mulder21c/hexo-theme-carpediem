const util = require(`hexo-util`);
const _stripHTML = util.stripHTML;

/**
 * @desc Strip HTML tags from string
 * @param {string} str - the original string
 * @return {string}
 */
function stripHTML(str) {
  return _stripHTML(
    str
      // ensuring whitespace between elements
      .replace(/</g, " <")
      // removing line indicators generated by syntax-highlighter
      .replace(/(<td class="gutter">)[^(td)]*(\/td>)/g, "")
      // converting special characters
      .replace(/&#(\d+);/g, (_, dec) => `${String.fromCharCode(dec)}`)
  );
}

module.exports = stripHTML;
